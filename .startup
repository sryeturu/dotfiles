#!/usr/bin/bash

# Wallpaper path
WALLPAPER_PATH=~/wallpapers/cotton_candy_seerlight.jpg

killall -q polybar
while pgrep -x polybar >/dev/null; do sleep 1; done

xrandr --output HDMI-1 --off

monitor_count=$(xrandr | grep "\bconnected\b" | wc -l)

if [ "$monitor_count" -eq 2 ]; then
	xrandr --output HDMI-1 --auto --above eDP-1
fi 

feh --no-fehbg --bg-scale "$WALLPAPER_PATH"

killall -q picom
while pgrep -x picom > /dev/null; do sleep 1; done
picom &

killall -q redshift
while pgrep -x redshift > /dev/null; do sleep 1; done
redshift &

killall -q dunst
while pgrep -x dunst > /dev/null; do sleep 1; done
dunst &

killall -q flameshot
while pgrep -x flameshot > /dev/null; do sleep 1; done
flameshot &

#setting the monitor variable before starting polybar
MONITOR=eDP-1 polybar main &

if [ "$monitor_count" -eq 2 ]; then
	MONITOR=HDMI-1 polybar main &
fi
